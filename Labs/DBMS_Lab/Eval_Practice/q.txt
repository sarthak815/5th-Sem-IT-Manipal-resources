CREATE TABLE EMPLOYEE(EMPLOYEE_NAME VARCHAR(20), 
	  	EMPLOYEE_ID INT PRIMARY KEY NOT NULL,
		STREET VARCHAR(15),
		CITY VARCHAR(15));
CREATE TABLE BRANCH(BRANCH_ID INT PRIMARY KEY NOT NULL,
		CITY VARCHAR(20),
		BRANCH_NAME VARCHAR(20));
CREATE TABLE WORKS(EMPLOYEE_ID INT,
		BRANCH_ID INT,
		FOREIGN KEY(EMPLOYEE_ID) REFERENCES EMPLOYEE,
		FOREIGN KEY(BRANCH_ID) REFERENCES BRANCH);
CREATE TABLE PROJECT(PROJECT_ID INT PRIMARY KEY NOT NULL,
		EMPLOYEE_ID INT,
		PROJECT_NAME VARCHAR(20),
		NO_HOURS INT,
		FOREIGN KEY(EMPLOYEE_ID) REFERENCES EMPLOYEE);


INSERT INTO EMPLOYEE VALUES('RAM', 1, 'YOLO', 'DELHI'); 
INSERT INTO EMPLOYEE VALUES('SAM', 2, 'LOLO', 'DUBAI');
INSERT INTO EMPLOYEE VALUES('TOM', 3, 'TOLO', 'PARIS');
INSERT INTO EMPLOYEE VALUES('LAMM', 4, 'POLO', 'MUSCAT');
INSERT INTO EMPLOYEE VALUES('ADAM', 5, 'NATIH', 'MUSCAT');

INSERT INTO BRANCH VALUES(1,'MUSCAT','SHATTI');
INSERT INTO BRANCH VALUES(2,'DUBAI','DEIRA');
INSERT INTO BRANCH VALUES(3,'PARIS','CHAMPS-ELYSEE');
INSERT INTO BRANCH VALUES(4,'DELHI','CP');

INSERT INTO WORKS VALUES(1,4);
INSERT INTO WORKS VALUES(2,2);
INSERT INTO WORKS VALUES(3,3);
INSERT INTO WORKS VALUES(4,1);
INSERT INTO WORKS VALUES(5,1);

INSERT INTO PROJECT VALUES(1,1,'AAA',10);
INSERT INTO PROJECT VALUES(2,2,'BBB',12);
INSERT INTO PROJECT VALUES(3,3,'CCC',8);
INSERT INTO PROJECT VALUES(4,4,'DDD',6);
INSERT INTO PROJECT VALUES(5,5,'EEE',15);

SELECT BRANCH_NAME FROM
(SELECT BRANCH_NAME, COUNT(BRANCH_NAME) FROM 
WORKS NATURAL LEFT JOIN BRANCH 
GROUP BY BRANCH_NAME 
ORDER BY COUNT(BRANCH_NAME) DESC)
WHERE ROWNUM=1;

SELECT EMPLOYEE_NAME, STREET, BRANCH_ID 
FROM EMPLOYEE NATURAL JOIN WORKS
WHERE EMPLOYEE_ID IN
(SELECT EMPLOYEE_ID FROM PROJECT WHERE PROJECT_ID = 2);

D
CREATE OR REPLACE PROCEDURE DEL_BRANCH(P_BRANCH_NAME IN BRANCH.BRANCH_NAME%TYPE)
AS
BEGIN
	DELETE FROM BRANCH WHERE BRANCH_NAME = P_BRANCH_NAME;
	DBMS_OUTPUT.PUT_LINE("RECORD DELETED");
END;
/

